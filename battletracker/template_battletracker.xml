<?xml version="1.0" encoding="utf-8"?>

<!-- 
  Please see the license.html file included with this distribution for 
  attribution and copyright information.
-->

<root>
	<template name="unitsummary_divider">
		<genericcontrol>
			<anchored height="3">
				<left parent="" offset="5" />
				<right parent="" offset="-6" />
			</anchored>
			<frame name="separatorline" />
			<disabled />
		</genericcontrol>
	</template>
	
	<template name="battletracker_content_unitlist">
		<list_content_top name="list">
			<class>battletracker_unit</class>
			<sortby><control>name</control></sortby>
			<columns width="180" fillwidth="true" />
			<allowdelete />
			<script>
				function onDrop(x, y, draginfo)
					return window.onDrop(x, y, draginfo);
				end
				function onListChanged()
					if window and window.onUnitListChanged then
						window.onUnitListChanged();
					end
				end
			</script>
		</list_content_top>
	</template>
	<template name="battletracker_unitlist">
		<windowlist name="list">
			<anchored>
				<left />
				<top parent="" offset="34" />
				<right />
			</anchored>
			<class>battletracker_unit</class>
			<sortby><control>name</control></sortby>
			<allowdelete />
			<script>
				function onDrop(x, y, draginfo)
					return window.onDrop(x, y, draginfo);
				end
				function onListChanged()
					if window and window.onUnitListChanged then
						window.onUnitListChanged();
					end
				end
			</script>
		</windowlist>
	</template>

	<template name="number_bt_controls_morale">
		<number_listitem_base>
			<script>
				function onInit()
					local sFaction = faction[1];
					if sFaction or "" ~= "" then
						setFrame("ctentrybox_" .. sFaction, 25, 2, 2, 5);
					end
				end
			</script>
		</number_listitem_base>
	</template>

	<template name="number_bt_unitstat">
		<number_ct>
			<anchored width="20" height="20" />
			<default>0</default>
			<script>
				function action(draginfo)
					local rActor = ActorManager.resolveActor(window.getDatabaseNode());
					local rAction = {};
					rAction.label = StringManager.capitalize(target[1]);
					rAction.stat = target[1];
					rAction.modifier = getValue();
					rAction.defense = (defense or {""})[1];

					ActionTest.performRoll(draginfo, rActor, rAction);
					return true;
				end
				
				function onDragStart(button, x, y, draginfo)
					return action(draginfo);
				end

				function onDoubleClick(x,y)
					return action();
				end
			</script>
		</number_ct>
	</template>
</root>
